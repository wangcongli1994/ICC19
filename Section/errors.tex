\subsection{HTTPS Errors}
%    In this subsection,
%    we focus on various types of errors that may trigger browser security warnings.
This section lists
the HTTPS errors of certificate verification of basic fields and extensions,
 name validation, and HTTPS security-enhancement.

\subsubsection{Basic Certificate Validation Error}
    Chain building Error occurs
    if the certificate chain presented by a web server
    cannot provide enough information for a browser to build a complete chain
    from the endpoint certificate to a trusted root certificate in the browser¡¯s root store.

\textbf{Untrusted Root CA Certificate.}
    Untrusted root CA certificate means that 
        the root certificate of the certificate chain is not trusted by the browser.
%    This error occurs when the chain of intermediate CAs linking the server certificate to a root CA untrusted by browsers.
    
\textbf{Untrusted Self-signed Server Certificate.}
    Self-signed server certificate is a special case of root CA certificates. 
        %whose subject and issuer are the same.
    Similarly, self-signed certificate is not trusted by browsers and must be installed manually.
    
\textbf{Incomplete Certificate Chain.}
    Incomplete certificate chain means that 
    a complete certificate chain cannot be formed due to the lack of intermediate certificates.
    %In order to build a complete certificate chain,
    %browsers obtain the intermediate certificates in three ways.
    %First, the web server presents its server certificate accompany with all the necessary intermediate certificates that can leads to a trusted root certificate.
    %Second, browsers reuse the cached intermediate certificates.
    %Third, browsers actively fetch the missing intermediate certificates through an AIA field.
    %An incomplete chain error occurs, when all the attempts fail.

\textbf{Expired Certificate.}
    A certificate is only valid between its Not Before date and Not After date. An expired certificate error occurs if the Not After date is earlier than current time.

\textbf{Revoked Certificate.}
    For security reasons,
    CA can claim that a certificate is no longer valid before it expires by CRL, OCSP, and CRLset.
    A revoked certificate error occurs when the server uses a revoked certificate.

\textbf{Weak Signature Algorithm.}

    %The CA/Browser Forum allows RSA and ECC keys in certificates.
    %All RSA keys should be at least 2048 bits \cite{CAB2018BR},
    %and ECC keys should be at least 256 bits \cite{NIST2005ECC}.
    %A weak signature algorithm error occurs when the key length does not meet the requirements.

\textbf{Weak Digest Algorithm.}
    Weak Signature algorithm refers to the unsafe, collidable algorithm, such as SHA-1 \cite{Google2017sha1} and MD5 \cite{wang2004collisions}.
    %According to the CA/Browser Forum,
    %supported digest algorithms are SHA-256, SHA-384, and SHA-512. The SHA-1 and MD5 digest algorithm have been shown to be insecure, such as two different PDF files with the same SHA-1 hash \cite{Google2017sha1}.

\subsubsection{Certificate Extension Validation Error}
    In addition to the basic certificate validation, we also consider the certificate extension validation: Basic Constraints, Key Usage, and Extended Key Usage.

\textbf{Basic Constraints Extension.}
    The basic constraints extension consists of a "CA flag" and a PathLenConstraint.
    CA certificates must set the "CA flag" as true.
    PathLenConstraint is a non-negative integer, and it only works for CA certificates.
    The number of intermediate certificates between current CA and the server certificate cannot greater than PathLenConstraint.

\textbf{Key Usage Extension.}
    The key usage extension indicates the purpose of the public key contained in a certificate.
    According to RFC 5280 \cite{cooper2008rfc5280},
    all CA certificates must include "Certificate Signing" in their key usage extension, and
    all webhost certificates must include "Key Encipherment" in their key usage extension.

\textbf{Extended Key Usage Extension.}
    Extended key usage extension further refines key usage extension.
    If the extension is critical,
    all server certificates must include "serverAuth" in their extended key usage extension.


\subsubsection{Name Validation Error}
    Certificates are only valid for specific domain names.
    A name validation error occurs when domain names listed in a server certificate does not match the domain we visited.

\textbf{Domain Name Complete Mismatch.}
    Domain Name Complete Mismatch means that, there may be a complete mismatch between the domain name visited and the certificate received.
    For example, a user tries to visit www.baidu.com but gets a certificates for scholar.google.com.

\textbf{Common Name or Subject Alternative Name Mismatch.}
    Common Name (CN) and Subject Alternative Name (SAN) fields indicate the certificate subject identity information, and they are usually domain names.
    There are many kinds of errors with respect to CN and SAN, for example, CN does not match the domain name visited, SAN does not match the domain name visited, and the lack of CN/SAN.

\textbf{WWW Mismatch.}
    A www mismatch occurs when a user visiting www.example.com gets a certificates for example.com.

\textbf{Out-of-wildcard-scope Subdomain.}
    A out-of-wildcard-scope subdomain occurs when a user visiting a.b.example.com gets a certificates for *.example.com.


\subsubsection{HTTPS Security-Enhancement Error}
%\subsubsection{Certificate verification enhancement errors}
    In recent years, some security-enhancement policies have been added to HTTPS. We will focus on HSTS and HPKP errors.

\textbf{HPKP.}
%    HTTP Public Key Pinning (HPKP) \cite{Evans2015rfc7469} is used by web sites to instruct browsers to remember ("pin") the sites' public key over a period of time.
    A HPKP \cite{Evans2015rfc7469} error occurs when
    any public key of the certificate chain provided by the website
    does not match the pinned public keys.

\textbf{HSTS.}
    HTTP Strict Transport Security (HSTS) \cite{hodges2012rfc6797} directs browsers to interact with given sites only over HTTPS.
%    This policy is declared by web sites via the STS header field including three directives: max-age, includeSubDomains, and preload.
    An HSTS error occurs when a web site deploying HSTS has a certificate validation error.
