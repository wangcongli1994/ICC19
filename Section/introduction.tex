\section{Introduction}
HTTPS is becoming the de facto standard of secure web applications
 to provide  authentication, data confidentiality and integrity.
It is used for hundreds of million of times every day in browsers \cite{felt2017measuring}.
HTTPS implements HTTP over TLS,
    and in the TLS negotiation, a browser verifies the server certificate by building a valid certificate chain,
    and validates the certificate subject with the domain that it is visiting.
Recently,
    the security of HTTPS is enhanced by HPKP that pins the public key (or certificate) of the web server in browsers \cite{xx},
     and HSTS that forces browsers to visit the web server only using HTTPS but not HTTP \cite{xxx}.

There are several errors in the TLS negotiations and also the security enhancements of HTTPS.
Browsers show security warnings with different levels, when different HTTPS errors happen:
(\emph{a}) a low-risk warning is shown in the address bar, no interrupting the browsing;
(\emph{b}) a medium-risk warning is shown as a full-screen page, interrupting the browsing,
    and the user may choose to ignore the warning by actively clicking a button to continue the browsing;
(\emph{c}) a high-risk one is also shown as a full-screen page, stopping the browsing,
    but the user may choose to retry by actively clicking a button;
and (\emph{d}) a fatal warning immediately close the connection and stop the browsing.

These security warnings try to protect users to establish secure connections with the target web server,
    but not a man-in-the-middle attack.
However, in order to balance security and usability,
    each browser implements its own design of security procedures,
        producing different behaviors and warnings on HTTPS errors.
In this paper,
        we present a comprehensive list of HTTPS errors,
and investigate the browser behaviors on each error.
These errors cover certificate verification of basic fields and extensions, 
        name validation, and HTTPS security-enhancement of HPKP and HSTS.

The evaluated browsers are Chrome, Firefox, and IE on Windows 7, and Edge on Windows 10.
Our study
    discloses several browser defects on handling HTTPS errors in terms of cryptographic algorithm,
     certificate extension, name validation,
      certificate revocation, and self-signed certificate.
Some defects may allow an invalid or forged certificate to be accepted by users:
\begin{itemize}
\item
Edge algorithm.
\item
Firefox pathLenConstraint.
\item
Chrome, certificate revocation.
\end{itemize}
There are also some defects resulting in the problems of usability:
\begin{itemize}
\item
Name validation, different. usability problem.
\item
Firefox does not support self-signed certificate as server certificate. usability problem.
\end{itemize}
%The main process of web browser certificate validation is as follows:
%    The web server sends an endpoint certificate referencing its domain name,
%    as well as one or more intermediate certificates to a browser.
%    The browser must construct a trust chain from its trusted root certificates to the endpoint.
%    Certificate validation involves checking the whole chain for
%    that the visited domain name matches the subject in the certificate presented by the web server,
%    that the digital signature value is valid,
%    that all the certificates of the chain are within their validity period,
%    that the certificates haven¡¯t been revoked, that various extensions are meet requirements,
%    and many other checks.
%    If that validation fails,
%    browsers display HTTPS security warnings to warn users of potential network attacks.
%    However, if warnings cannot communicate risks correctly, uses may make wrong decisions.


%Our work focuses on the X.509 certificate validation rather than the whole process of HTTPS implements,
%    but we hope our work can be useful for deploying HTTPS faster and better.

We make the following contributions:
\begin{itemize}
\item We thoroughly analyzed various HTTPS errors and HTTPS browser security warnings for mainstream browsers.
\item Based on the analysis results, we found that some browsers didn't handle properly,
    for example,
    firefox displays medium-risk warnings for manually installed self-signed certificates,
    chrome displays secure for revoked certificates that only contain CRL information or OCSP information,
    IE and Edge don¡¯t provide any warning for MD5 and SHA-1 certificates,
    and chrome provide medium-risk warnings for certificates whose SAN fields don't contain the domain we visited.
    We accordingly make recommendations for browser warnings to convey appropriate levels of risk.
\end{itemize}






